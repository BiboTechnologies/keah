<!DOCTYPE html>
<html lang="en" >
<head>
  <meta charset="UTF-8">
  <title>Bibo Medical Systems </title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/signature_pad/1.5.3/signature_pad.min.js"></script>

   <!-- Include the jQuery library -->
   <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
   <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
   <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
   <link href="BMS logo only.png" rel="icon">
 <script src="./jspdf/dist/jspdf.umd.min.js"></script>
 <script src="./jspdf-autotable/dist/jspdf.plugin.autotable.js"></script>
<!-- Add this script tag in the head section or before the end of the body section -->
<script src="https://cdn.jsdelivr.net/npm/moment"></script>

  <!-- Include the html2canvas library -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.2/html2canvas.min.js"></script>

   <!-- Include the Select2 CSS and JS files -->
   <link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet" />
   <script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>
   
   <link rel='stylesheet' href='https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css'>
<link rel='stylesheet' href='https://cdnjs.cloudflare.com/ajax/libs/gentelella/1.3.0/css/custom.css'>
<link rel='stylesheet' href='https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css'><link rel="stylesheet" href="./portal.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/5.0.2/js/bootstrap.bundle.min.js"></script>
</head>

<!-- partial:index.partial.html -->
<body class="nav-md">
<!-- Splash screen content -->
<div id="splashScreen">
  <div id="logo"></div>
  <div id="loadingText"></div>
</div>
<div class="container body">
  <div class="main_container">
    <div class="col-md-3 left_col">
      <div class="left_col scroll-view">
        <div class="navbar nav_title" style="border: 0;">
          <a href="index.html" class="site_title">
            <img class="dashImg" src="BMS logo only.png" alt="Dashboard Image">
            <span>BIBO MEDSYS</span>
        </a>
                </div>

        <div class="clearfix"></div>

        <!-- menu profile quick info -->
        <div class="profile clearfix">
          <div class="profile_pic">
            <img id="profilePreview" src="" alt="..." class="img-circle profile_img">
          </div>
          <div class="profile_info">
  <span>Welcome,</span>
  <h2 id="profileName"></h2>
</div>

        </div>
        <!-- /menu profile quick info -->

        <br />

        <!-- sidebar menu -->
        <div id="sidebar-menu" class="main_menu_side hidden-print main_menu">
          <div class="menu_section">
            <h3>General</h3>
            <ul class="nav side-menu">
              <li><a><i class="fa fa-home"></i> Home <span class="fa fa-chevron-down"></span></a>
                <ul class="nav child_menu">
                  <li><a href="index.html">Dashboard Management</a></li>
                  <li><a href="cashier.html">Cashier Desk</a></li>

            <!--     <li><a href="index2.html">Dashboard2</a></li>
                  <li><a href="index3.html">Dashboard3</a></li>--> 
                </ul>
              </li>
              <li><a><i class="fa fa-edit"></i>Treatment<span class="fa fa-chevron-down"></span></a>
                <ul class="nav child_menu">
                  <li><a href="laboratory.html">Laboratory</a></li>
                  <li><a href="patients.html">Patients Reception</a></li>
                  <li><a href="odp.html">Patient's on Treatment</a></li>
                 <li><a href="doctors.html">Doctor's Room</a></li>
                 <li><a href="dental.html">Dental Department</a></li>
                 <li><a href="scan.html">Scan Department</a></li>
                 <li><a href="babies.html">Babies Department</a></li>


                </ul>
              </li>
              <li><a><i class="fa fa-medkit"></i>Medicine<span class="fa fa-chevron-down"></span></a>
                <ul class="nav child_menu">
                 <li><a href="medicines.html">Medicine Store</a></li>
                <!--   <li><a href="media_gallery.html">Media Gallery</a></li>
                  <li><a href="typography.html">Typography</a></li>
                  <li><a href="icons.html">Icons</a></li>
                  <li><a href="glyphicons.html">Glyphicons</a></li>
                  <li><a href="widgets.html">Widgets</a></li>
                  <li><a href="invoice.html">Invoice</a></li>
                  <li><a href="inbox.html">Inbox</a></li>
                  <li><a href="calendar.html">Calendar</a></li>
                </ul>
              </li>
              <li><a><i class="fa fa-table"></i> Tables <span class="fa fa-chevron-down"></span></a>
                <ul class="nav child_menu">
                  <li><a href="tables.html">Tables</a></li>
                  <li><a href="tables_dynamic.html">Table Dynamic</a></li>-->
                </ul>
              </li>
              <li><a><i class="fa fa-bar-chart-o"></i> Data Analytics <span class="fa fa-chevron-down"></span></a>
                <ul class="nav child_menu">
                  <li><a href="sales.html">Data Entry</a></li>
               <!--    <li><a href="revenue.html"> Data Entry Analytics</a></li>
              <li><a href="tests.html">Tests</a></li>
                    <li><a href="echarts.html">ECharts</a></li>
                  <li><a href="other_charts.html">Other Charts</a></li>-->
                </ul>
              </li>
            <li><a><i class="fa fa-clone"></i>Management<span class="fa fa-chevron-down"></span></a>
                <ul class="nav child_menu">
                  <li><a href="staff.html">Hospital Staff</a></li>
               <li><a href="insurance.html">Insurance </a></li>              
              
              
                </ul>
              </li>
            </ul>
          </div>
       <div class="menu_section">
            <ul class="nav side-menu">
              <li><a><i class="fa fa-bug"></i>Tests & Prescription<span class="fa fa-chevron-down"></span></a>
               <ul class="nav child_menu">
                  <li><a href="clinical.html">Clinical Tests  & Prescriptions</a></li>
               <!--   <li><a href="projects.html">Projects</a></li>
                  <li><a href="project_detail.html">Project Detail</a></li>
                  <li><a href="contacts.html">Contacts</a></li>
                  <li><a href="profile.html">Profile</a></li>
                </ul>
              </li>
              <li><a><i class="fa fa-windows"></i> Extras <span class="fa fa-chevron-down"></span></a>
                <ul class="nav child_menu">
                  <li><a href="page_403.html">403 Error</a></li>
                  <li><a href="page_404.html">404 Error</a></li>
                  <li><a href="page_500.html">500 Error</a></li>
                  <li><a href="plain_page.html">Plain Page</a></li>
                  <li><a href="login.html">Login Page</a></li>
                  <li><a href="pricing_tables.html">Pricing Tables</a></li>
                </ul>
              </li>
              <li><a><i class="fa fa-sitemap"></i> Multilevel Menu <span class="fa fa-chevron-down"></span></a>
                <ul class="nav child_menu">
                  <li><a href="#level1_1">Level One</a>
                    <li><a>Level One<span class="fa fa-chevron-down"></span></a>
                      <ul class="nav child_menu">
                        <li class="sub_menu"><a href="level2.html">Level Two</a>
                        </li>
                        <li><a href="#level2_1">Level Two</a>
                        </li>
                        <li><a href="#level2_2">Level Two</a>
                        </li>
                      </ul>
                    </li>
                    <li><a href="#level1_2">Level One</a>
                    </li>-->
                </ul>
                </li>
                <li><a href="javascript:void(0)"><i class="fa fa-laptop"></i> Landing Page <span class="label label-success pull-right">Coming Soon</span></a></li>
            </ul>
          </div>

        </div>
        <!-- /sidebar menu -->

     
        <div class="sidebar-footer hidden-small">
     <!--   <a data-toggle="tooltip" data-placement="top" title="Settings">
            <span class="glyphicon glyphicon-cog" aria-hidden="true"></span>
          </a>-->
          <a data-toggle="tooltip" data-placement="top" title="FullScreen">
            <span class="glyphicon glyphicon-fullscreen" aria-hidden="true"></span>
          </a>
          
          <a data-toggle="tooltip" data-placement="top" title="Lock">
            <span class="glyphicon glyphicon-eye-close" aria-hidden="true"></span>
          </a>
       <a data-toggle="tooltip" data-placement="top" title="Logout" href="#" id="closesession">
            <span id="onlineStatus" aria-hidden="true"></span>
          </a>
          <a data-toggle="tooltip" data-placement="top" title="Logout" href="#" id=""></a>
            <span class="glyphicon glyphicon-chevron-up" aria-hidden="true"></span>
          </a>
        </div> 
        <script>
// Get the eye close button element
const eyeCloseButton = document.querySelector('.sidebar-footer .glyphicon-eye-close');
// Get the sidebar footer element
const sidebarFooter = document.querySelector('.sidebar-footer');

// Add event listener to the eye close button
eyeCloseButton.addEventListener('click', function() {
  // Hide the sidebar footer
  sidebarFooter.style.display = 'none';
});

// Get the fullscreen button element
const fullscreenButton = document.querySelector('.sidebar-footer .glyphicon-fullscreen');

// Add event listener to the fullscreen button
fullscreenButton.addEventListener('click', function() {
  if (document.documentElement.requestFullscreen) {
    document.documentElement.requestFullscreen();
  } else if (document.documentElement.mozRequestFullScreen) { // Firefox
    document.documentElement.mozRequestFullScreen();
  } else if (document.documentElement.webkitRequestFullscreen) { // Chrome, Safari, and Opera
    document.documentElement.webkitRequestFullscreen();
  } else if (document.documentElement.msRequestFullscreen) { // IE/Edge
    document.documentElement.msRequestFullscreen();
  }
});

          </script>
        <!-- /menu footer buttons -->
      </div>
    </div>

    <!-- top navigation -->
    <div class="top_nav">
      <div class="nav_menu">
        
        <nav>
          
          <div class="nav toggle">
            
            <a id="menu_toggle"><i class="fa fa-bars"></i></a>
            
          </div>

          <ul class="nav navbar-nav navbar-right">
            
            <li class="">
              <a href="javascript:;" class="user-profile dropdown-toggle" data-toggle="dropdown" aria-expanded="false">
                <img src="" alt="">
                <span class=" fa fa-angle-down"></span>
              </a>
          <ul class="dropdown-menu dropdown-usermenu pull-right">
                  <li><a href="javascript:;"> Profile</a></li>
                <li>
                  <a href="javascript:;">
                    <span class="badge bg-red pull-right">50%</span>
                    <span>Settings</span>
                  </a>
                </li>
                <li><a href="javascript:;">Help</a></li>
                <li>
                  <a href="#" id="logoutButton">
                    <i class="fa fa-sign-out"></i> Log Out
                  </a>
                </li>              </ul>
            </li>

            <li role="presentation" class="dropdown">
              <a id="envelope-icon" href="javascript:;" class="dropdown-toggle info-number" data-toggle="dropdown" aria-expanded="false">
                <i class="fa fa-envelope-o" ></i>
                <span id="notDoneCount" class="badge bg-green" ></span>
              </a>
              
              
            </li>
            <li role="presentation" class="dropdown">
              <a id="list" href="javascript:;" class="dropdown-toggle info-number" data-toggle="dropdown" aria-expanded="false">
                <i class="fas fa-list" ></i>
                <span id="listCount" class="badge bg-green" ></span>
              </a>

              
            </li>
          </ul>
        </nav>
      </div>
    </div>
    <!-- /top navigation -->
 </div>
    <!-- page content -->
    <style>

      th, td {
        padding: 8px;
        border-bottom: 1px solid #ddd;
      }
      
      th {
        text-align: left;
      }
      
      table {
        width: 100%;
        border-collapse: collapse;
        border-bottom: 1px solid #ddd;
      }
      .recordKeyData {
        font-weight: bold;
      }
      
      .paymentStatusData {
        font-weight: bold;
      }
      
      .paymentStatusData.red {
        color: red;
      }
      
      .paymentStatusData.blue {
        color: blue;
      }
      
      .resultsObtainedData {
        font-weight: bold;
      }
      
      .resultsObtainedData.orange {
        color: orange;
      }
      /* General Button Styling */
.btn {
  display: inline-flex;
  align-items: center;
  gap: 8px;
  font-size: 16px;
  font-weight: bold;
  padding: 10px 20px;
  border: none;
  border-radius: 8px;
  background-color: #007bff; /* Primary blue color */
  color: #fff;
  cursor: pointer;
  text-transform: uppercase;
  transition: all 0.3s ease;
  box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
}

/* Add Report Specific Styling */
.btn-add-report {
  background-color: #28a745; /* Green color for "Add" action */
}

.btn-add-report:hover {
  background-color: #218838; /* Darker green on hover */
  box-shadow: 0 6px 8px rgba(0, 0, 0, 0.15);
  transform: translateY(-2px);
  color: #fff;
}

.btn-add-report:active {
  background-color: #1e7e34; /* Even darker green on click */
  box-shadow: 0 3px 5px rgba(0, 0, 0, 0.2);
  transform: translateY(1px);
}

/* Icon Styling */
.btn i {
  font-size: 18px;
}

      </style>

     <div style="z-index: 10000;" id="message"></div>

     
    <div class="right_col" role="main">
     <div id="loginoverlay">  <div id="errorContainer" class="error-message" style="color: red;"></div>
</div>

    <!-- Add the container for error messages -->

<div id="loginpopup" class="loginpopup">

  <div class="login-container">
  <div class="login-form">
    <h2 style="color: white;">Enter your credentials</h2>
    <!-- Use a form to handle form submission -->
    <form id="loginForm">
      <label style="color: white;" for="email">Email:</label>
      <input type="email" id="email" required>
      <label style="color: white;" for="password">Password:</label>
      <input type="password" id="password" required>
      <button type="submit"  id="submitBtn">Submit</button>
      <!-- Add a link for Forgot Password -->
      <a href="#" id="forgotPasswordLink" style="color: white;">Forgot Password?</a>
    </form>
  </div>
  <!-- Details about Bibo Medical Systems -->
  <div class="bibo-details">
    <h3 style="color: rgb(255, 255, 255);" class="title">
      <i class="fas fa-hospital"></i> Bibo Medical Systems | Your Healthcare Assistant
    </h3>
    <p style="color: rgb(255, 255, 255);">
      Bibo Medical Systems is a state-of-the-art Hospital Management System that aims to revolutionize healthcare services. With cutting-edge technology and a team of dedicated healthcare professionals, we provide comprehensive medical solutions to enhance patient care and streamline hospital operations.
    </p>
    <p style="color: rgb(255, 255, 255);">
      Our advanced system offers features such as electronic health records (EHR), patient billing, pharmacy management, and more. We prioritize data security and ensure that patient information remains confidential and protected.
    </p>
<!--   <p style="color: rgb(255, 255, 255);">
      At Bibo Medical Systems, we focus on patient-centric care, providing personalized treatment plans and fostering a compassionate environment for healing. Our hospital management system optimizes workflows, reduces administrative burdens, and empowers healthcare providers to deliver efficient and effective services.
    </p>--> 
    <p style="color: rgb(255, 255, 255);">
      Whether you're a patient seeking top-notch medical care or a healthcare professional looking to streamline hospital operations, Bibo Medical Systems is your reliable healthcare assistant.
    </p>
    <p style="color: rgb(255, 255, 255);">
      Experience the future of healthcare management with Bibo Medical Systems. Your well-being is our priority, and we are committed to delivering excellence in healthcare services every step of the way.
    </p>
  </div>
</div>
</div>

<script>
 
</script>

      <section>
   <!-- Profile Button -->
<button id="openProfileBtn" class="btn btn-danger">Profile</button>

<!-- Profile Sidebar -->
<div id="profileSidebar" class="profile-sidebar">
  <div class="sidebar-header">
    <h3>My Profile</h3>
    <button id="closeProfileSidebar" class="close-sidebar">&times;</button>
  </div>

  <!-- Profile display -->
  <div id="profileDisplay" class="profile-card">
    <div class="profile-pic-container">
      <img id="profilePreview" src="k.png" alt="Profile Photo" class="profile-photo">
    </div>
    <div class="profile-details">
      <h2 id="displayName">User</h2>
      <p id="displayEmail">user@example.com</p>
      <p id="lastLogin">Last Login: N/A</p>
      <button id="editProfileBtn" class="btn-edit">Edit Profile</button>
    </div>
  </div>

  <!-- Profile edit form -->
  <form id="profileForm" class="profile-form" style="display:none;">
    <label>Display Name</label>
    <input type="text" id="displayNameInput" placeholder="Enter name">
    <label>Email (readonly)</label>
    <input type="email" id="displayEmailInput" readonly>
    <label>Profile Photo</label>
    <input type="file" id="profilePhotoInput" accept="image/*">
    <button type="submit" class="btn-save">Save</button>
  </form>
</div>

<!-- Sidebar overlay -->
<div id="sidebarOverlay" class="sidebar-overlay"></div>

        <button id="uploadBtn"><i class="fa fa-plus"></i>Register Patient</button>
        <div style="margin: auto;" class="search-container">
          <input type="text" id="searchInput" placeholder="Search by name or ID ...">
          <button id="searchButton"><i class="fas fa-search"></i> </button> 
        </div>
        <button id="addReportBtn" class="btn btn-add-report">
          <i class="fa fa-plus"></i> Add Report
        </button>
        
        
        </section>
         
        
  
             <div id="overlay"></div>

        <div id="loader" class="loader"></div> <!--<div class="sort-container">
            <label class="sort-label" for="sortSelect"></label>
            <select id="sortSelect" class="sort-select">
             <option value="expiry">Sort by Expiry Date</option>
              <option value="alphabetical">Sort Alphabetically</option>
            </select>
          </div>--> 
          
<div class="dental-department-title">
  <!-- Hospital Logo + Name -->
  <div class="hospital-header">
    <img src="k.jpg" alt="Keah Medical Center Logo" class="hospital-logo">
    <span class="hospital-name">Keah Medical Center - Nsambya</span>
  </div>

  <!-- Reception Desk Section -->
  <div class="reception-section">
    <i class="fas fa-key"></i>
    <span>Reception Desk</span>
  </div>
</div>
<div id="viewResultsPopup">
  <div class="popup-content">
    <h3 id="viewResultsHeader">Results</h3>  
      <button class="close-popup-button">Close</button>

    <div id="viewResultsContainer"></div>
  </div>
</div>



          <!-- Add a div for pagination -->
            <div id="pagination" class="pagination">
              <!-- Pagination buttons will be rendered here -->
            </div>

          <!-- Your existing table -->
            <div id="patients" class="patient-table">
              <!-- Your table content goes here -->
            </div>

            
       
            
            <div class="action-center">
              <div class="chat-overlay" id="chatOverlay"></div>
              <div class="chat-button">
                <button id="openChatBtn"><i class="fas fa-comment"></i><span id="unreadMessageCount">0</span></button>
              </div>
              <div class="chat-container" id="chatContainer">
                <div class="action-header">Chat Room</div>
                <div id="chatBox"></div>
                <div class="message-input-container">
                  <button id="callButton"><i class="fas fa-phone"></i> Call</button>
                  <input type="text" id="messageInput" placeholder="Type your message...">
                  <button id="sendMessageBtn"><i class="fas fa-paper-plane"></i></button>
                </div>
              </div>
              <!-- Header of the action center -->
              <div class="action-header">Action Center</div>
              <span id="actionCenter"></span>
              <!-- Button to send a message -->
            </div>
            

 <!-- The Modal -->
 <div id="callModal" class="modal">
  <div class="modal-content">
    <span class="close">&times;</span>
    <p>Select where the call is going to:</p>
   <!-- Buttons -->
<button id="receptionButton" class="styled-button">Reception</button>
<button id="labButton" class="styled-button">Lab</button>
<button id="doctorRoomButton" class="styled-button">Doctor's Room</button>

<!-- Modal -->
<div id="callModal" class="modal">
  <div class="modal-content">
    <span class="close">&times;</span>
    <p>Select destination:</p>
    <button id="receptionButton" class="styled-button">Reception</button>
    <button id="labButton" class="styled-button">Lab</button>
    <button id="doctorRoomButton" class="styled-button">Doctor's Room</button>
  </div>
</div>

  </div>
</div>
       
 <!-- Overlay -->
<div id="popupOverlay2" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.5); z-index: 999;"></div>

<!-- Popup Modal -->
<div id="reportPopup" style="display: none; position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); width: 400px; height: 90%; padding: 20px; background: #fff; box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2); border-radius: 8px; z-index: 1000; overflow-y: auto;">
  <h3>Add Daily Report</h3>
  <form id="reportForm">
    <label for="reportTitle"><strong>Report Title (Date):</strong></label><br>
    <input type="text" id="reportTitle" name="reportTitle" required readonly style="width: 100%; padding: 8px; margin-top: 5px; margin-bottom: 15px;"><br>
    
    <label for="totalPatients"><strong>Total Patients Registered:</strong></label><br>
    <input type="number" id="totalPatients" name="totalPatients" required style="width: 100%; padding: 8px; margin-top: 5px; margin-bottom: 15px;"><br>

    <label for="totalTests"><strong>Total Tests Done Today:</strong></label><br>
    <input type="number" id="totalTests" name="totalTests" required style="width: 100%; padding: 8px; margin-top: 5px; margin-bottom: 15px;"><br>

    <label for="followUpAppointments"><strong>Follow-up Appointments Scheduled:</strong></label><br>
    <input type="number" id="followUpAppointments" name="followUpAppointments" required style="width: 100%; padding: 8px; margin-top: 5px; margin-bottom: 15px;"><br>

    <label for="reportDescription"><strong>Additional Notes:</strong></label><br>
    <textarea id="reportDescription" name="reportDescription" rows="4" style="width: 100%; padding: 8px; margin-top: 5px; margin-bottom: 15px;"></textarea><br>
    
    <button type="submit" class="btn btn-submit-report">Submit</button>
    <button type="button" id="closeReportPopup" style="display: none;" class="btn btn-close-popup">Close</button>
  </form>
</div>



        <!-- Popup Overlay -->
        <div class="popup-overlay" id="popupOverlay1">
          <div class="popup">
            <span class="popup-close" id="popupClose1">&times;</span>  
            <div id="patientDetails"></div>
 
<input type="text" id="testSearch" placeholder="Search tests by record key">
            <h2 style=" margin-bottom: 30px;">Medical History</h2>

            <div id="patientHistory"></div>
          </div>
        </div>


        <div class="popup-overlay" id="addMedicationPopupOverlay">
          <div class="popup">
            <span class="popup-close" id="addMedicationPopupClose">&times;</span>
        
            <h2>Add Test Results</h2>
            <form id="addMedicationForm" data-patient-name="">
              <label for="resultsObtained">Results Obtained:</label>
              <input type="text" id="resultsObtained" required>
              <label for="medicationTaken">Medication Given:</label>
              <div id="medicationInputsContainer">
                <div id="medication"></div>        
              </div>
              
              <button id="addMedicationButton" type="button">+ Add</button>
              <label for="additionalNotes">Additional Notes:</label>
              <input type="text" id="additionalNotes" required>
              <div id="totalCost"></div>
              <button type="submit" id="submitMedicationButton">Submit</button>


            </form>
          </div>
        </div>
        
<!-- The popup overlay -->
<div id="popup-overlay4" class="popup-overlay4">
  <div class="popup-content4" id="popup-content4">
    <h2>Triage History</h2>
    <div id="allVisitsData">
      <table class="table2">
        <thead>
          <tr>
            <th>Date</th>
            <th>Clinician's Name</th>
            <th>Temperature (&deg;C)</th>
            <th>BP (mmHg)</th>
            <th>RR</th>
            <th>HR</th>
            <th>SpO2</th>
            <th>WT (Kg)</th>
            <th>HT (cm)</th>
            <th>BMI</th>
            <th>MUAC</th>
            <th>WT for Age Z score</th>
            <th>Disability</th>
            <th>Known Chronic Illness</th>
            <th>Any Drug Abuse</th>
            <th>Allergies</th>
          </tr>
        </thead>
        <tbody id="tableBody">
        </tbody>
      </table>   <div id="trendAnalysisDiv"></div>
     <canvas id="visitTrendChart" style="max-width: 100%; margin-top: 20px;"></canvas>
    
    </div>
    
    <button id="closePopupBtn4">Close</button>
 
  </div>
  
</div>

<div id="confirmationPopup" class="confirmation-popup">
  <div class="popup-header">
    <span id="closePopupBtn" class="close-popup-btn">&times;</span>
    <div class="draggable-notice">You can drag this popup around</div>
    <h2>Approve Service Payment</h2>
  </div>

<!-- Add the section to display the total -->
<div id="totalSection">
  <label for="total">Total:</label>
  <span id="totalAmount">0.00</span>
</div>
<!-- Add the section to display the total 

<label for="totalCost">(Consumables and Sundries) if available:</label>
<input type="text" id="consumables" placeholder="Enter Total Cost" required>
-->
  <label for="testsTaken">Services to be Offered:</label>
  <input type="text" style="width: 100%;" id="testsTaken" readonly required>
    <!-- Add more options as needed -->
</input>
<!-- Add the button -->
<button id="calculateTotalButton">Calculate Total</button>

  <label for="amount">Cash Tendered:</label>
  <input type="text" id="amountInput" placeholder="Enter Cash Received" required>
  <!-- Balance/Change Input -->
  <label for="balance">Balance/Change:</label>
  <input type="text" id="balanceInput" placeholder="Balance or Change" readonly required>

  <label for="patientId">Patient ID/Reason of payment:</label>
  <input type="text" id="patientIdInput" placeholder="Enter Patient ID/Reason for payment" required>

  <!-- Department Dropdown -->
  <label for="department">Department:</label>
  <select id="department" required>
    <option value="" disabled selected>Select a department</option>
    <option value="Laboratory">Laboratory</option>
    <option value="Dental">Dental</option>
    <option value="Scan">Scan</option>
    <option value="Theater">Theater</option>
    <option value="General">General</option>
    <option value="Maternity">Maternity</option>
  </select>

  <!-- Mode of Payment Dropdown -->
  <label for="paymentMode">Mode of Payment:</label>
  <select id="paymentMode" required>
    <option value="" disabled selected>Select a payment mode</option>
    <option value="Cash">Cash</option>
    <option value="Mobile Money">Mobile Money</option>
    <option value="Insurance">Insurance</option>
    <option value="Credit Card">Credit Card</option>
    <option value="Merchant">Merchant</option>
  </select>


  <button type="submit" id="confirmPaymentBtn">Confirm Payment</button>
</div>




<div id="confirmationPopupClone" class="confirmation-popup" >
  <div class="popup-header">
    <span id="closePopupBtnClone" class="close-popup-btn">&times;</span>
    <div class="draggable-notice">You can drag this popup around</div>
    <h2>Enter Payment Details</h2>
  </div>

  <label for="consumablesClone">(Consumables and Sundries) if available:</label>
  <input type="text" id="consumablesClone" placeholder="Enter Total Cost" required>

  <label for="patientIdClone">Patient ID/Reason of payment:</label>
  <input type="text" id="patientIdInputClone" placeholder="Enter Patient ID/Reason for payment" required>

  <!-- Department Dropdown -->
  <label for="departmentClone">Department:</label>
  <select id="departmentClone" required>
    <option value="" disabled selected>Select a department</option>
    <option value="laboratory">Laboratory</option>
    <option value="dental">Dental</option>
    <option value="scan">Scan</option>
    <option value="theater">Theater</option>
    <option value="general">General</option>
    <option value="maternity">Maternity</option>
  </select>

  <!-- Mode of Payment Dropdown -->
  <label for="paymentModeClone">Mode of Payment:</label>
  <select id="paymentModeClone" required>
    <option value="" disabled selected>Select a payment mode</option>
    <option value="Cash">Cash</option>
    <option value="Mobile Money">Mobile Money</option>
    <option value="Insurance">Insurance</option>
    <option value="Credit Card">Credit Card</option>
    <option value="Merchant">Merchant</option>
  </select>

  <button type="submit" id="confirmPaymentBtnClone">Confirm Payment</button>
</div>









<div id="listPopupOverlay">
  <div id="listPopup">
    <span id="listPopupClose">&times;</span>
    <h2>Waiting List</h2>
    <!-- Add these buttons where you want them to appear -->
     <button id="notseen" class="filter-button"> <i class="fas fa-eye-slash"></i>Not Seen</button>
     <button id="seen" class="filter-button"><i class="fas fa-check-circle"></i>Seen</button>

    <ul id="waitinglist"></ul>

  </div>
</div>


<div id="labRequestsPopupOverlay">
  <div id="labRequestsPopup">
    <span id="labRequestsPopupClose">&times;</span>
    <h2>Laboratory Results</h2>
    <!-- Add these buttons where you want them to appear -->
<!-- Add these buttons where you want them to appear -->
<button id="notDoneBtn" class="filter-button">
  <i class="fas fa-eye-slash"></i> Not Yet Cleared
</button>
<button id="completedBtn" class="filter-button">
  <i class="fas fa-check-circle"></i> Cleared
</button>
    <ul id="labRequestsList"></ul>

  </div>
</div>

        <!-- The popup overlay -->
<!-- The popup overlay -->
<div id="popup-overlay3" class="popup-overlay3">
  <form class="popup-content3">
    <h2 id="visitPopupTitle"></h2>
    <h2>Clinician</h2>
    <label for="clinicianName">Clinician's Name:</label>
    <select style="width: 100%;" id="clinicianName" required>
      <option value="" disabled selected>Select an Clinician</option>
      <!-- Options will be dynamically populated by JavaScript -->
    </select>

    <h2>Vital Signs</h2>
    <div class="vital-signs">
      <input type="text" id="temperature" placeholder="Temperature (&deg;C)">
      <input type="text" id="bp" placeholder="BP (mmHg)" inputmode="numeric" pattern="\d{3}/\d{3}" title="Please enter blood pressure in the format 000/000 mmHg" required>

      <input type="text" id="rr" placeholder="RR">
      <input type="text" id="hr" placeholder="HR">
      <input type="text" id="sp02" placeholder="SpO2 (%)">
      <input type="text" id="wt" placeholder="WT (Kg)">
      <input type="text" id="ht" placeholder="HT (cm)">
      <input type="text" id="bmi" placeholder="BMI">
      <input type="text" id="muac" placeholder="MUAC">
      <input type="text" id="weightForAgeZScore" placeholder="Weight for Age Z score">
    </div>

    <h4>Additional Information</h4>
    <input type="text" id="disability" placeholder="Disability">
    <input type="text" id="chronicIllness" placeholder="Known Chronic Illness">
    <input type="text" id="drugAbuse" placeholder="Any Drug Abuse">
    <h2>Allergies</h2>
    <select style=" width: 100%;" id="allergies" multiple >
      <!-- Add more options as needed -->
    </select>

    <!-- Add the "Save Visit" and "Cancel" buttons inside the form -->
    <button style=" margin-top: 20px;" type="button" id="saveVisitBtn">Save Visit</button>
    <button style=" margin-top: 20px; background: red;" type="button" id="cancelVisitBtn">Cancel</button>
  </form>
</div>
<script>
const bloodPressureInput = document.getElementById('bp');

bloodPressureInput.addEventListener('input', (event) => {
  const inputValue = event.target.value.replace(/\D/g, ''); // Remove non-digit characters from input

  if (inputValue.length > 6) {
    event.target.value = inputValue.slice(0, 6); // Limit to 6 characters (3 for each part)
  } else if (inputValue.length > 3) {
    const firstPart = inputValue.slice(0, 3);
    const secondPart = inputValue.slice(3); // Grab everything after the first 3 characters

    // Reconstruct the value with the separator '/'
    event.target.value = `${firstPart}/${secondPart}`;
  }
});


</script>
<div id="editPopupOverlay"></div>
<div id="editPopup" class="popup">
  <div>
    <span class="popup-close" id="closeEditPopup">&times;</span>
    <h2>Edit Patient Details</h2>
    <p id="patientIdDisplay"></p>
    <label for="editedName">Patient's Name:</label>
    <input type="text" id="editedName" placeholder="Name" required>
    <label for="editedDOB">Date of Birth:</label>
    <input type="date" id="editedDOB" placeholder="Date of Birth" required>
    <label for="editedTel">Telephone Contact:</label>
    <input type="tel" id="editedTel" placeholder="Telephone Contact" required><br>
    <button id="saveEditedDetails" class="button save-button">Save Changes</button>
  </div>
</div>
  <div id="existingPatientsPopup" class="">
    <span id="closePopup" class="">&times;</span>
    <div id="existingPatientsContent"></div>
  </div>


        <!-- Popup Overlay -->
        <div class="popup-overlay" id="addRecordPopupOverlay">
          <div class="popup">
            <span class="popup-close" id="addRecordPopupClose">&times;</span>
            <h2>Add Medical Record</h2>
            <form id="addRecordForm" data-patient-name="">
               <label for="testsTaken">Test Taken:</label>
                   <select style="width: 100%;" id=""  required>
                     <!-- Add more options as needed -->
                   </select>

              
             <!-- <label for="resultsObtained">Results Obtained:</label>
              <input type="text" id="resultsObtained" required>
              <label for="medicationTaken">Medication Given:</label>
              <div id="medicationInputsContainer">
                 <div id="medication"></div>
                <button id="addMedicationButton" type="button">+ Add</button>

              </div>
              
              
              <label for="additionalNotes">Additional Notes:</label>
              <input type="text" id="additionalNotes" required>
              <div id="totalCost"></div>-->
              <button type="submit">Submit</button>
            </form>
          </div>
        </div>

      
        <button id="fetchPatientCountBtn"> <i class="fas fa-sync-alt"></i>
               Fetch New Patient Count</button>
        <div class="popup-overlay" id="popupOverlay">
          <div class="popup">
            
            <span class="popup-close" id="popupClose">&times;</span>
            
            <h2>Register New Patient</h2>
            <div id="existingPatients"></div>
            <form class="popup-form" id="addPatientForm">
              <label for="name">Full Name:</label>
              <input type="text" id="name" required>
              
              <label for="age">Age:</label>
<input type="number" id="age" min="0" max="120" placeholder="Enter age">

<label for="dob">Date of Birth:</label>
<input type="date" id="dob" required>

              
              <label for="parents">Telephone Contact:</label>
              <div class="telephone-input">
                <input type="text" id="parentsCountryCode" value="+256" >
                <input type="tel" id="parents" required placeholder="Enter phone number...">
              </div>
              
              <label for="NOK">Next of Kin's Telephone Contact:</label>
              <div class="telephone-input">
                <input type="text" id="NOKCountryCode" value="+256" >
                <input type="tel" id="NOK" required placeholder="Enter phone number...">
              </div>
              

              <label for="residence">Place of Residence:</label>
              <input type="text" id="residence" required>
              
              <label for="payment">Payment Terms:</label>
              <select id="payment" required>
                <option value="cash">Cash</option>
                <option value="insurance">Insurance</option>
                <option value="other">Other</option>
              </select>
              
              <label for="sex">Sex:</label>
              <select id="sex" required>
                <option value="male">Male</option>
                <option value="female">Female</option>
                <option value="other">Other</option>
              </select>
              

              
              <button type="submit">Submit</button>
             
            </form>
            
            
          </div>
     
        </div>
      </div>
      
    <div id="overlay2"></div>
<!-- Signature Popup -->
<div id="signaturePopup" style="display: none;">
  <div>
    <h2>Doctor's Signature</h2>
    <canvas id="signatureCanvas"></canvas>
    <button id="clearSignature">Clear</button>
    <button id="saveSignature"><i class="fas fa-save"></i> Save</button>
  </div>
  <button id="closeSignaturePopup" class="close-button"><i class="fas fa-times"></i></button>

</div>

    

    
      
      

    <!-- /page content -->



    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.4.0/jspdf.umd.min.js"></script>

<!-- Firebase libraries -->
<script type="module" src="https://www.gstatic.com/firebasejs/9.0.2/firebase-app.js"></script>
<script type="module" src="https://www.gstatic.com/firebasejs/9.0.2/firebase-database.js"></script>
<script type="module" src="https://www.gstatic.com/firebasejs/9.0.2/firebase-auth.js"></script>
<script type="module" src="https://www.gstatic.com/firebasejs/9.0.2/firebase-storage.js"></script>
<script src="./jspdf/dist/jspdf.umd.min.js"></script>
 <script src="./jspdf-autotable/dist/jspdf.plugin.autotable.js"></script>
 <!-- Include the html2canvas library -->
 <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.2/html2canvas.min.js"></script>
 <script src="https://cdn.jsdelivr.net/jsbarcode/3.6.0/JsBarcode.all.min.js"></script>

<script type="module" src="patients.js">
</script>
<!-- Include the jQuery library -->
<script src='https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js'></script>
<script src='https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js'></script>

<!-- Include the Select2 CSS and JS files -->
<link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet" />
<script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>

<script src="./portal.js"></script>

<style>
  .select2-container {
    z-index: 9999; /* Adjust the z-index value as needed */
  }
</style>

<script>
  $(document).ready(function() {
    // Initialize Select2 for the first select element
    $('#allergies').select2({
      dropdownParent: $('body')
    });

    // Initialize Select2 for the select elements inside '.medication-input-container' within '.popup3'
    $('.popup3 .medication-input-container select').select2({
      dropdownParent: $('.popup3')
    });
  });


  const ageInput = document.getElementById('age');
const dobInput = document.getElementById('dob');

// Set max date to today to prevent future DOB
const today = new Date();
dobInput.max = today.toISOString().split('T')[0];

// When age is entered, calculate a random DOB within that year
ageInput.addEventListener('input', () => {
  let age = parseInt(ageInput.value);
  if (isNaN(age)) return;

  // Clamp age between 0 and 120
  age = Math.max(0, Math.min(120, age));
  ageInput.value = age;

  const birthYear = today.getFullYear() - age;

  // Random month and day
  const month = Math.floor(Math.random() * 12); // 0-11
  const day = Math.floor(Math.random() * 28) + 1; // avoids month-length issues

  let dob = new Date(birthYear, month, day);

  // Ensure DOB is not in the future
  if (dob > today) dob = today;

  dobInput.valueAsDate = dob;
});

// When DOB is changed, update the age input
dobInput.addEventListener('change', () => {
  const dob = new Date(dobInput.value);
  if (isNaN(dob)) return;

  let age = today.getFullYear() - dob.getFullYear();
  const m = today.getMonth() - dob.getMonth();
  if (m < 0 || (m === 0 && today.getDate() < dob.getDate())) age--;

  // Clamp age between 0 and 120
  age = Math.max(0, Math.min(120, age));
  ageInput.value = age;
});

</script>


<!-- Rest of your HTML code -->

</body>
</html>
